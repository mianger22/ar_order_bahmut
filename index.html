<html>
  <head>
    <script src="ar_libraries/aframe-master/dist/aframe-v1.6.0.min.js"></script>
    <script src="ar_libraries/AR.js-3.4.0/aframe/build/aframe-ar.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>

      <!-- Собственное расположение моделей -->
      <a-entity id="modelGallery" rotation="0 0 0">
        <!-- Модели, расположенные по окружности -->
        <a-entity id="model1" gltf-model="#model1" position="0.5 0 -3" scale="0.5 0.5 0.5" class="clickable"></a-entity>
        <a-entity id="model2" gltf-model="#model2" position="0 0 -4" scale="0.5 0.5 0.5" class="clickable"></a-entity>
        <a-entity id="model3" gltf-model="#model3" position="-0.5 0 -3" scale="0.5 0.5 0.5" class="clickable"></a-entity>
      </a-entity>

      <!-- Камера + cursor для выбора -->
      <a-entity camera position="0 1.6 0" look-controls>
        <a-entity 
          cursor="fuse: false; rayOrigin: mouse" 
          raycaster="objects: .clickable" 
          position="0 0 -1" 
          geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03" 
          material="color: yellow; shader: flat">
        </a-entity>
      </a-entity>

      <!-- Assets для моделей -->
      <a-assets>
        <a-asset-item id="model1" src="./models/kazakh_dombra.glb"></a-asset-item>
        <a-asset-item id="model2" src="./models/kazakh_dombra.glb"></a-asset-item>
        <a-asset-item id="model3" src="./models/kazakh_dombra.glb"></a-asset-item>      
      </a-assets>

      <script>
        // Переменные для состояния
        let selectedModel = null;
        let isRotating = false;
        let lastX = 0;

        // Обработки выбора модели через клик
        document.querySelector('a-scene').addEventListener('click', (evt) => {
          // Ищем объект, по которому кликнули
          const intersectedEl = evt.target.components['raycaster']?.intersectedEls[0];

          if (intersectedEl && intersectedEl.classList.contains('clickable')) {
            selectedModel = intersectedEl;
            // Возможно, показать UI или что-то другое
          }
        });

        // Представление мыши
        document.querySelector('a-scene').addEventListener('mousedown', (evt) => {
          if (selectedModel) {
            isRotating = true;
            lastX = evt.clientX;
          }
        });

        document.addEventListener('mouseup', () => {
          isRotating = false;
        });

        // Обработка движения мыши
        document.addEventListener('mousemove', (evt) => {
          if (isRotating && selectedModel) {
            const deltaX = evt.clientX - lastX;
            const currentRotation = selectedModel.getAttribute('rotation');
            selectedModel.setAttribute('rotation', {
              x: currentRotation.x,
              y: currentRotation.y + deltaX * 0.5,
              z: currentRotation.z
            });
            lastX = evt.clientX;
          }
        });

        // Для мобильных устройств
        document.addEventListener('touchstart', (evt) => {
          if (selectedModel && evt.touches.length === 1) {
            isRotating = true;
            lastX = evt.touches[0].clientX;
          }
        });
        document.addEventListener('touchend', () => {
          isRotating = false;
        });
        document.addEventListener('touchmove', (evt) => {
          if (isRotating && selectedModel && evt.touches.length === 1) {
            const deltaX = evt.touches[0].clientX - lastX;
            const currentRotation = selectedModel.getAttribute('rotation');
            selectedModel.setAttribute('rotation', {
              x: currentRotation.x,
              y: currentRotation.y + deltaX * 0.5,
              z: currentRotation.z
            });
            lastX = evt.touches[0].clientX;
          }
        });
      </script>
    </a-scene>
  </body>
</html>































