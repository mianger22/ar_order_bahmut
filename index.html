<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>AR модели с вращением</title>
    <script src="ar_libraries/aframe-master/dist/aframe-v1.6.0.min.js"></script>
    <script src="ar_libraries/AR.js-3.4.0/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
<a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
  <!-- Модели в assets -->
  <a-assets>
    <!-- Замените URL на свои модели или оставьте -->
    <a-asset-item id="model1" src="https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models@master/2.0/Box/glTFBox.gltf"></a-asset-item>
    <a-asset-item id="model2" src="https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models@master/2.0/CesiumMan/glTF/CesiumMan.gltf"></a-asset-item>
  </a-assets>

  <!-- Галерея моделей -->
  <a-entity id="models-container" position="0 0 -3">
    <a-entity id="model1"
              class="clickable"
              gltf-model="#model1"
              position="0.5 0 0"
              scale="0.5 0.5 0.5"
              rotation="0 0 0"></a-entity>

    <a-entity id="model2"
              class="clickable"
              gltf-model="#model2"
              position="-0.5 0 0"
              scale="0.5 0.5 0.5"
              rotation="0 0 0"></a-entity>
  </a-entity>

  <!-- Камера с курсором -->
  <a-entity camera look-controls>
    <a-entity cursor="fuse: false; rayOrigin: mouse"
              raycaster="objects: .clickable"
              position="0 0 -1"
              geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
              material="color: yellow; shader: flat">
    </a-entity>
  </a-entity>

  <script>
    let selectedModel = null; // выбранная модель
    let isRotating = false;
    let lastX = 0;

    const sceneEl = document.querySelector('a-scene');

    // Обработка выбора модели
    sceneEl.addEventListener('click', () => {
      const intersectedEls = sceneEl.querySelectorAll('.clickable');
      const intersects = sceneEl.components['raycaster'].intersectedEls;
      if (intersects && intersects.length > 0) {
        const el = intersects[0];
        if (el.classList.contains('clickable')) {
          selectedModel = el;
          alert('Модель выбрана. Перетаскивайте мышью или касанием для вращения.');
        }
      }
    });

    // Начало вращения по мыши
    document.addEventListener('mousedown', () => {
      if (selectedModel) {
        isRotating = true;
      }
    });

    // Конец вращения
    document.addEventListener('mouseup', () => {
      isRotating = false;
    });

    // Вращение мышью
    document.addEventListener('mousemove', (evt) => {
      if (isRotating && selectedModel) {
        const deltaX = evt.movementX;
        const rotation = selectedModel.getAttribute('rotation');
        selectedModel.setAttribute('rotation', {
          x: rotation.x,
          y: rotation.y + deltaX * 0.5,
          z: rotation.z
        });
      }
    });

    // Аналогично для касаний
    document.addEventListener('touchstart', () => {
      if (selectedModel) {
        isRotating = true;
      }
    });
    document.addEventListener('touchend', () => {
      isRotating = false;
    });
    document.addEventListener('touchmove', (evt) => {
      if (isRotating && selectedModel && evt.touches.length === 1) {
        const deltaX = evt.touches[0].clientX - lastX;
        lastX = evt.touches[0].clientX;
        const rotation = selectedModel.getAttribute('rotation');
        selectedModel.setAttribute('rotation', {
          x: rotation.x,
          y: rotation.y + deltaX * 0.5,
          z: rotation.z
        });
      }
    });

    // Обновляем lastX при касании
    document.addEventListener('touchstart', (evt) => {
      if (evt.touches.length === 1) {
        lastX = evt.touches[0].clientX;
      }
    });
  </script>
</a-scene>
</body>
</html>





















































